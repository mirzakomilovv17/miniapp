<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mini App Form</title>
</head>
<body>
  <h2>Register</h2>

  <input id="name" placeholder="Your name"><br><br>
  <input id="phone" placeholder="Phone number"><br><br>

  <button id="sendBtn">Send</button>

  <p id="result"></p>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    document.getElementById("sendBtn").onclick = async function () {
        const name = document.getElementById("name").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const user_id = tg.initDataUnsafe.user?.id;

        if (!name || !phone) {
            alert("Iltimos barcha maydonlarni toâ€˜ldiring!");
            return;
        }

        const payload = { user_id, name, phone };
        console.log("Yuborilayotgan:", payload);

        const res = await fetch("https://miniapp-backend-ejgl.onrender.com/save", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
        });

        const data = await res.json();
        document.getElementById("result").innerText = JSON.stringify(data);
        console.log("Server javobi:", data);
    };
  </script>
</body>
</html>
